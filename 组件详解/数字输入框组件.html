<!DOCTYPE html>
<html lang="en" style="font-size: 36px;">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="../css/reset.css">
  <link rel="stylesheet" href="../css/main.css">
  <title>Document</title>
</head>
<body>
  <div id="app">
    <p>
      <span>父组件内获取到的值:</span>
      <span v-text="fatherNumber"></span>
    </p>
    <number-component :value="fatherNumber" v-model="fatherNumber"></number-component>
  </div>
  
  <script src="../vue.js"></script>
  <script src="../js/easy.js"></script>
  <script>
    Vue.component('number-component', {
      template: `<div>
        <input type="button" value=" - " @click="reduce(1)">
        <input type="text" v-model="currentValue" @keyup.up="add(1)" @keyup.down="reduce(1)" @change="updateValue">
        <input type="button" value=" + " @click="add(1)">
        <input type="button" value=" -- " @click="reduce(fastValue)">
        <span>设置间距:</span>
        <input v-model="fastValue" @change="checkFastValue"/>
        <input type="button" value=" ++ " @click="add(fastValue)">
      </div>`,
      data: function () {
        return {
          currentValue: 0,
          fastValue: 2,
        };
      },
      props: {
        value: {
          type: Number
        }
      },
      watch: {
        value: function (newValue, oldValue) {
          this.currentValue = newValue;
        }
      },
      methods: {
        add: function (value) {
          if (!this.checkFastValue) return;
          this.currentValue = Number(this.currentValue) + Number(value);
          this.updateValue();
        },
        reduce: function (value) {
          if (!this.checkFastValue) return;
          this.currentValue = Number(this.currentValue) - Number(value);
          this.updateValue();
        },
        updateValue: function () {
          this.$emit('input', this.currentValue);
        },
        checkFastValue: function () {
          var reg = /^[1-9]\d*$/;
          if (!reg.test(this.fastValue)) {
            this.fastValue = 2;
            console.log('快进值应为正整数');
            return false;
          } else if (this.fastValue < 2) {
            this.fastValue = 2;
            console.log('快进值不能小于2');
            return false;
          }
          return true;
        }
      }
    })

    var app = new Vue({
      el: '#app',
      data: {
        fatherNumber: 0
      },
      methods: {

      },
      computed: {

      },
      mounted: function() {
        var _this = this;
        setTimeout(function () {
          _this.fatherNumber = 3;
        });
      }
    });
  </script>
</body>
</html>